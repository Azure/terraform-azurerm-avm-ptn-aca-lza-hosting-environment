<!-- BEGIN_TF_DOCS -->
<!-- Code generated by terraform-docs. DO NOT EDIT. -->
# terraform-azurerm-avm-template

This is a template repo for Terraform Azure Verified Modules.

<!-- markdownlint-disable MD033 -->
## Requirements

The following requirements are needed by this module:

- <a name="requirement_terraform"></a> [terraform](#requirement\_terraform) (>= 1.9, < 2.0)

- <a name="requirement_azapi"></a> [azapi](#requirement\_azapi) (~> 2.4)

- <a name="requirement_modtm"></a> [modtm](#requirement\_modtm) (~> 0.3)

- <a name="requirement_null"></a> [null](#requirement\_null) (~> 3.0)

- <a name="requirement_random"></a> [random](#requirement\_random) (~> 3.5)

## Resources

The following resources are used by this module:

- [modtm_telemetry.telemetry](https://registry.terraform.io/providers/azure/modtm/latest/docs/resources/telemetry) (resource)
- [null_resource.resource_group_validation](https://registry.terraform.io/providers/hashicorp/null/latest/docs/resources/resource) (resource)
- [random_uuid.telemetry](https://registry.terraform.io/providers/hashicorp/random/latest/docs/resources/uuid) (resource)
- [azapi_client_config.naming](https://registry.terraform.io/providers/Azure/azapi/latest/docs/data-sources/client_config) (data source)
- [azapi_client_config.telemetry](https://registry.terraform.io/providers/Azure/azapi/latest/docs/data-sources/client_config) (data source)
- [modtm_module_source.telemetry](https://registry.terraform.io/providers/azure/modtm/latest/docs/data-sources/module_source) (data source)

<!-- markdownlint-disable MD013 -->
## Required Inputs

The following input variables are required:

### <a name="input_deployment_subnet_address_prefix"></a> [deployment\_subnet\_address\_prefix](#input\_deployment\_subnet\_address\_prefix)

Description: Required. The CIDR to use for Deployment scripts subnet.

Type: `string`

### <a name="input_enable_application_insights"></a> [enable\_application\_insights](#input\_enable\_application\_insights)

Description: Required. Enable or disable the creation of Application Insights.

Type: `bool`

### <a name="input_enable_dapr_instrumentation"></a> [enable\_dapr\_instrumentation](#input\_enable\_dapr\_instrumentation)

Description: Required. Enable or disable Dapr Application Instrumentation Key used for Dapr telemetry. If Application Insights is not enabled, this parameter is ignored.

Type: `bool`

### <a name="input_location"></a> [location](#input\_location)

Description: Required. The location of the Azure Container Apps deployment.

Type: `string`

### <a name="input_spoke_infra_subnet_address_prefix"></a> [spoke\_infra\_subnet\_address\_prefix](#input\_spoke\_infra\_subnet\_address\_prefix)

Description: Required. CIDR of the Spoke Infrastructure Subnet.

Type: `string`

### <a name="input_spoke_private_endpoints_subnet_address_prefix"></a> [spoke\_private\_endpoints\_subnet\_address\_prefix](#input\_spoke\_private\_endpoints\_subnet\_address\_prefix)

Description: Required. CIDR of the Spoke Private Endpoints Subnet.

Type: `string`

### <a name="input_spoke_vnet_address_prefixes"></a> [spoke\_vnet\_address\_prefixes](#input\_spoke\_vnet\_address\_prefixes)

Description: Required. CIDR of the Spoke Virtual Network.

Type: `list(string)`

## Optional Inputs

The following input variables are optional (have default values):

### <a name="input_bastion_resource_id"></a> [bastion\_resource\_id](#input\_bastion\_resource\_id)

Description: Optional. The resource ID of the bastion host. If set, the spoke virtual network will be peered with the hub virtual network and the bastion host will be allowed to connect to the jump box. Default is null.

Type: `string`

Default: `null`

### <a name="input_created_resource_group_name"></a> [created\_resource\_group\_name](#input\_created\_resource\_group\_name)

Description: Optional. Name to use when use\_existing\_resource\_group is true and the module is creating a resource group. Leave null for auto-generation.

Type: `string`

Default: `null`

### <a name="input_deploy_sample_application"></a> [deploy\_sample\_application](#input\_deploy\_sample\_application)

Description: Optional. Deploy sample application to the container apps environment. Default is false.

Type: `bool`

Default: `false`

### <a name="input_deploy_zone_redundant_resources"></a> [deploy\_zone\_redundant\_resources](#input\_deploy\_zone\_redundant\_resources)

Description: Optional. Default value is true. If true, any resources that support AZ will be deployed in all three AZ. However if the selected region is not supporting AZ, this parameter needs to be set to false. Default is true.

Type: `bool`

Default: `true`

### <a name="input_enable_bastion_access"></a> [enable\_bastion\_access](#input\_enable\_bastion\_access)

Description: Optional. Whether to enable bastion access rule in the VM NSG. Set to true when using a bastion host with a VM jumpbox. Default is false.

Type: `bool`

Default: `false`

### <a name="input_enable_ddos_protection"></a> [enable\_ddos\_protection](#input\_enable\_ddos\_protection)

Description: Optional. DDoS protection mode. see https://learn.microsoft.com/azure/ddos-protection/ddos-protection-sku-comparison#skus. Default is "false".

Type: `bool`

Default: `false`

### <a name="input_enable_egress_lockdown"></a> [enable\_egress\_lockdown](#input\_enable\_egress\_lockdown)

Description: Optional. Whether to enable egress lockdown by routing all traffic through a network appliance. When true, network\_appliance\_ip\_address must be provided. Default is false.

Type: `bool`

Default: `false`

### <a name="input_enable_hub_peering"></a> [enable\_hub\_peering](#input\_enable\_hub\_peering)

Description: Optional. Whether to enable peering with a hub virtual network. When true, hub\_virtual\_network\_resource\_id must be provided. Default is false.

Type: `bool`

Default: `false`

### <a name="input_enable_telemetry"></a> [enable\_telemetry](#input\_enable\_telemetry)

Description: This variable controls whether or not telemetry is enabled for the module.  
For more information see <https://aka.ms/avm/telemetryinfo>.  
If it is set to false, then no telemetry will be collected.

Type: `bool`

Default: `true`

### <a name="input_environment"></a> [environment](#input\_environment)

Description: Optional. The name of the environment (e.g. "dev", "test", "prod", "uat", "dr", "qa"). Up to 8 characters long. Default is "test".

Type: `string`

Default: `"test"`

### <a name="input_existing_resource_group_id"></a> [existing\_resource\_group\_id](#input\_existing\_resource\_group\_id)

Description: Optional. The resource ID of an existing resource group to use when use\_existing\_resource\_group is set to true. Default is null.

Type: `string`

Default: `null`

### <a name="input_expose_container_apps_with"></a> [expose\_container\_apps\_with](#input\_expose\_container\_apps\_with)

Description: Optional. Specify the way container apps is going to be exposed. Options are applicationGateway, frontDoor, or none. Default is "applicationGateway".

Type: `string`

Default: `"applicationGateway"`

### <a name="input_front_door_enable_waf"></a> [front\_door\_enable\_waf](#input\_front\_door\_enable\_waf)

Description: Optional. Enable Web Application Firewall for Front Door. Default is false.

Type: `bool`

Default: `false`

### <a name="input_front_door_waf_policy_name"></a> [front\_door\_waf\_policy\_name](#input\_front\_door\_waf\_policy\_name)

Description: Optional. Name of the WAF policy for Front Door. Required if front\_door\_enable\_waf is true. Default is null.

Type: `string`

Default: `null`

### <a name="input_generate_ssh_key_for_vm"></a> [generate\_ssh\_key\_for\_vm](#input\_generate\_ssh\_key\_for\_vm)

Description: Optional. Whether to auto-generate an SSH key for the Linux VM. When false, vm\_linux\_ssh\_authorized\_key must be provided if using SSH authentication. Default is false.

Type: `bool`

Default: `false`

### <a name="input_hub_virtual_network_resource_id"></a> [hub\_virtual\_network\_resource\_id](#input\_hub\_virtual\_network\_resource\_id)

Description: Optional. The resource ID of the hub virtual network. Required when enable\_hub\_peering is true. If set, the spoke virtual network will be peered with the hub virtual network. Default is null.

Type: `string`

Default: `null`

### <a name="input_log_analytics_workspace_replication_enabled"></a> [log\_analytics\_workspace\_replication\_enabled](#input\_log\_analytics\_workspace\_replication\_enabled)

Description: Optional. Enable cross-region replication for the Log Analytics workspace. Default is true. Set to false in test/example environments to avoid issues with resource destruction.

Type: `bool`

Default: `true`

### <a name="input_network_appliance_ip_address"></a> [network\_appliance\_ip\_address](#input\_network\_appliance\_ip\_address)

Description: Optional. IP address of the network appliance (e.g., Azure Firewall) for routing egress traffic. Required when enable\_egress\_lockdown is true. Default is null.

Type: `string`

Default: `null`

### <a name="input_route_spoke_traffic_internally"></a> [route\_spoke\_traffic\_internally](#input\_route\_spoke\_traffic\_internally)

Description: Optional. Define whether to route spoke-internal traffic within the spoke network. If false, traffic will be sent to the hub network. Default is false.

Type: `bool`

Default: `false`

### <a name="input_spoke_application_gateway_subnet_address_prefix"></a> [spoke\_application\_gateway\_subnet\_address\_prefix](#input\_spoke\_application\_gateway\_subnet\_address\_prefix)

Description: Optional. CIDR of the Spoke Application Gateway Subnet. Required when expose\_container\_apps\_with is 'applicationGateway'. Default is null.

Type: `string`

Default: `null`

### <a name="input_storage_account_type"></a> [storage\_account\_type](#input\_storage\_account\_type)

Description: Optional. The storage account type to use for the jump box. Defaults to `Premium_LRS` for APRL compliance.

Type: `string`

Default: `"Premium_LRS"`

### <a name="input_tags"></a> [tags](#input\_tags)

Description: Optional. Tags related to the Azure Container Apps deployment. Default is null.

Type: `map(string)`

Default: `null`

### <a name="input_use_existing_resource_group"></a> [use\_existing\_resource\_group](#input\_use\_existing\_resource\_group)

Description: Optional. Whether to use an existing resource group or create a new one. If true, the module will use the resource group specified in existing\_resource\_group\_id. If false, a new resource group will be created with the name specified in create\_resource\_group\_name (or selected one for you if not specified). Default is false.

Type: `bool`

Default: `false`

### <a name="input_vm_admin_password"></a> [vm\_admin\_password](#input\_vm\_admin\_password)

Description: Optional. The password to use for the Windows virtual machine. Required when vm\_jumpbox\_os\_type is 'windows'. Default is null.

Type: `string`

Default: `null`

### <a name="input_vm_jumpbox_os_type"></a> [vm\_jumpbox\_os\_type](#input\_vm\_jumpbox\_os\_type)

Description: Optional. The operating system type of the virtual machine. Default is "none" which results in no VM deployment.

Type: `string`

Default: `"none"`

### <a name="input_vm_jumpbox_subnet_address_prefix"></a> [vm\_jumpbox\_subnet\_address\_prefix](#input\_vm\_jumpbox\_subnet\_address\_prefix)

Description: Optional. CIDR to use for the virtual machine subnet. Required when vm\_jumpbox\_os\_type is not 'none'. Default is null.

Type: `string`

Default: `null`

### <a name="input_vm_linux_ssh_authorized_key"></a> [vm\_linux\_ssh\_authorized\_key](#input\_vm\_linux\_ssh\_authorized\_key)

Description: Optional. The SSH public key to use for the virtual machine. Required when vm\_jumpbox\_os\_type is 'linux', and generate\_ssh\_key\_for\_vm is false.

Type: `string`

Default: `null`

### <a name="input_vm_size"></a> [vm\_size](#input\_vm\_size)

Description: Optional. The size of the virtual machine to create. Required when vm\_jumpbox\_os\_type is not 'none'. See https://learn.microsoft.com/azure/virtual-machines/sizes for more information. Default is null.

Type: `string`

Default: `null`

### <a name="input_workload_name"></a> [workload\_name](#input\_workload\_name)

Description: Optional. The name of the workload that is being deployed. Up to 10 characters long.

Type: `string`

Default: `"aca-lza"`

## Outputs

The following outputs are exported:

### <a name="output_application_gateway_id"></a> [application\_gateway\_id](#output\_application\_gateway\_id)

Description: The resource ID of the Application Gateway (when deployed).

### <a name="output_application_gateway_public_ip"></a> [application\_gateway\_public\_ip](#output\_application\_gateway\_public\_ip)

Description: The public IP address of the Application Gateway (when deployed).

### <a name="output_application_insights_id"></a> [application\_insights\_id](#output\_application\_insights\_id)

Description: The resource ID of Application Insights (when enabled).

### <a name="output_container_apps_environment_default_domain"></a> [container\_apps\_environment\_default\_domain](#output\_container\_apps\_environment\_default\_domain)

Description: The default domain of the Container Apps Managed Environment.

### <a name="output_container_apps_environment_id"></a> [container\_apps\_environment\_id](#output\_container\_apps\_environment\_id)

Description: The resource ID of the Container Apps Managed Environment.

### <a name="output_container_apps_environment_private_dns_zone_id"></a> [container\_apps\_environment\_private\_dns\_zone\_id](#output\_container\_apps\_environment\_private\_dns\_zone\_id)

Description: The resource ID of the Private DNS Zone for the ACA environment default domain.

### <a name="output_container_apps_environment_static_ip"></a> [container\_apps\_environment\_static\_ip](#output\_container\_apps\_environment\_static\_ip)

Description: The static IP address of the Container Apps Managed Environment.

### <a name="output_container_registry_id"></a> [container\_registry\_id](#output\_container\_registry\_id)

Description: The resource ID of the Azure Container Registry.

### <a name="output_container_registry_login_server"></a> [container\_registry\_login\_server](#output\_container\_registry\_login\_server)

Description: The name of the container registry login server.

### <a name="output_container_registry_name"></a> [container\_registry\_name](#output\_container\_registry\_name)

Description: The name of the Azure Container Registry.

### <a name="output_container_registry_user_assigned_identity_id"></a> [container\_registry\_user\_assigned\_identity\_id](#output\_container\_registry\_user\_assigned\_identity\_id)

Description: The resource ID of the user-assigned managed identity for ACR pulls.

### <a name="output_front_door_endpoint_hostname"></a> [front\_door\_endpoint\_hostname](#output\_front\_door\_endpoint\_hostname)

Description: The hostname of the Front Door endpoint (*.azurefd.net with Microsoft-managed certificate, when deployed).

### <a name="output_front_door_id"></a> [front\_door\_id](#output\_front\_door\_id)

Description: The resource ID of the Front Door profile (when deployed).

### <a name="output_key_vault_id"></a> [key\_vault\_id](#output\_key\_vault\_id)

Description: The resource ID of the Azure Key Vault.

### <a name="output_key_vault_name"></a> [key\_vault\_name](#output\_key\_vault\_name)

Description: The name of the Azure Key Vault.

### <a name="output_linux_vm_id"></a> [linux\_vm\_id](#output\_linux\_vm\_id)

Description: The resource ID of the Linux jump box VM (when deployed).

### <a name="output_linux_vm_private_ip"></a> [linux\_vm\_private\_ip](#output\_linux\_vm\_private\_ip)

Description: The private IP address of the Linux jump box VM (when deployed).

### <a name="output_log_analytics_workspace_id"></a> [log\_analytics\_workspace\_id](#output\_log\_analytics\_workspace\_id)

Description: The resource ID of the Azure Log Analytics Workspace

### <a name="output_log_analytics_workspace_name"></a> [log\_analytics\_workspace\_name](#output\_log\_analytics\_workspace\_name)

Description: The name of the Azure Log Analytics Workspace

### <a name="output_resource_group_name"></a> [resource\_group\_name](#output\_resource\_group\_name)

Description: The name of the resource group where resources are deployed.

### <a name="output_resource_id"></a> [resource\_id](#output\_resource\_id)

Description: The resource ID of the primary resource (resource group) deployed by this pattern module.

### <a name="output_resource_type_abbreviations"></a> [resource\_type\_abbreviations](#output\_resource\_type\_abbreviations)

Description: Resource type abbreviations used in naming

### <a name="output_resources_names"></a> [resources\_names](#output\_resources\_names)

Description: Computed resource names from naming module

### <a name="output_sample_app_fqdn"></a> [sample\_app\_fqdn](#output\_sample\_app\_fqdn)

Description: The FQDN of the sample Container App (when deployed).

### <a name="output_sample_app_id"></a> [sample\_app\_id](#output\_sample\_app\_id)

Description: The resource ID of the sample Container App (when deployed).

### <a name="output_sample_app_name"></a> [sample\_app\_name](#output\_sample\_app\_name)

Description: The name of the sample Container App (when deployed).

### <a name="output_spoke_virtual_network_id"></a> [spoke\_virtual\_network\_id](#output\_spoke\_virtual\_network\_id)

Description: The resource ID of the spoke virtual network.

### <a name="output_storage_account_name"></a> [storage\_account\_name](#output\_storage\_account\_name)

Description: The account name of the storage account.

### <a name="output_storage_account_resource_id"></a> [storage\_account\_resource\_id](#output\_storage\_account\_resource\_id)

Description: The resource ID of the storage account.

## Modules

The following Modules are called:

### <a name="module_application_gateway"></a> [application\_gateway](#module\_application\_gateway)

Source: ./modules/application_gateway

Version:

### <a name="module_container_apps_environment"></a> [container\_apps\_environment](#module\_container\_apps\_environment)

Source: ./modules/container_apps_environment

Version:

### <a name="module_front_door"></a> [front\_door](#module\_front\_door)

Source: ./modules/front_door

Version:

### <a name="module_naming"></a> [naming](#module\_naming)

Source: ./modules/naming

Version:

### <a name="module_sample_application"></a> [sample\_application](#module\_sample\_application)

Source: ./modules/sample_application

Version:

### <a name="module_spoke"></a> [spoke](#module\_spoke)

Source: ./modules/spoke

Version:

### <a name="module_spoke_resource_group"></a> [spoke\_resource\_group](#module\_spoke\_resource\_group)

Source: Azure/avm-res-resources-resourcegroup/azurerm

Version: 0.2.0

### <a name="module_supporting_services"></a> [supporting\_services](#module\_supporting\_services)

Source: ./modules/supporting_services

Version:

<!-- markdownlint-disable-next-line MD041 -->
## Data Collection

The software may collect information about you and your use of the software and send it to Microsoft. Microsoft may use this information to provide services and improve our products and services. You may turn off the telemetry as described in the repository. There are also some features in the software that may enable you and Microsoft to collect data from users of your applications. If you use these features, you must comply with applicable law, including providing appropriate notices to users of your applications together with a copy of Microsoftâ€™s privacy statement. Our privacy statement is located at <https://go.microsoft.com/fwlink/?LinkID=824704>. You can learn more about data collection and use in the help documentation and our privacy statement. Your use of the software operates as your consent to these practices.
<!-- END_TF_DOCS -->